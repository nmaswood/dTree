function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.dTree=e()}(this,function(){"use strict";var t=function(){function t(e,n,r){_classCallCheck(this,t),t.DEBUG_LEVEL=r.debug?1:0,this.root=e,this.siblings=n,this.opts=r,this.allNodes=this._flatten(this.root);var a=_.filter(this.allNodes,function(t){return!t.hidden});this.nodeSize=r.callbacks.nodeSize(a,r.nodeWidth,r.callbacks.textRenderer)}return _createClass(t,[{key:"create",value:function(){var t=this.opts,e=(this.allNodes,this.nodeSize),n=t.width+t.margin.left+t.margin.right,r=t.height+t.margin.top+t.margin.bottom,a=d3.zoom().scaleExtent([.1,10]).on("zoom",function(){i.attr("transform",d3.event.transform.translate(n/2,t.margin.top))}),i=this.svg=d3.select(t.target).append("svg").attr("width",n).attr("height",r).call(a).append("g").attr("transform","translate("+n/2+","+t.margin.top+")");this.tree=d3.tree().nodeSize([2*e[0],2.5*e[1]]),this.tree.separation(function(t,e){return t.data.hidden||e.data.hidden?.3:.6}),this._update(this.root)}},{key:"_update",value:function(e){var n=this.opts,r=(this.allNodes,this.nodeSize,this.tree(e)),a=r.links(),i=this.svg.selectAll(".link").data(a).enter().filter(function(t){return!t.target.data.noParent});i.append("path").attr("class",n.styles.linage).attr("d",this._elbow);var o=d3.format(".0%");i.append("text").attr("x",function(t){var e=(t.source,t.target);return e.x+"px"}).attr("y",function(t){t.source,t.target;return t.target.y-47+"px"}).style("fill","gray").attr("font-family","Source Sans Pro, sans-serif").attr("font-weight",800).attr("font-size","10px").attr("text-anchor","middle").text(function(t){var e=(t.source,t.target),n=e.data.percentage;return o(n)});var c=this.svg.selectAll(".node").data(r.descendants()).enter(),s=c.append("svg").filter(function(t){return!t.data.hidden}).attr("x",function(t){return t.x-t.cWidth/2+"px"}).attr("y",function(t){return t.y-t.cHeight/2+"px"}).attr("width",function(t){return t.cWidth+"px"}).attr("height",function(t){return t.cHeight+"px"}).attr("id",function(t){return t.id}),u=(t._nodeRenderer(s),this.svg.selectAll(".news-exclamation").data(r.descendants()).enter().filter(function(t){return null!=t.data.news}));u.append("text").attr("class","fas fa-exclamation-triangle").attr("x",function(t){return t.x+30+"px"}).attr("y",function(t){return t.y-t.cHeight/2+9+"px"}).style("cursor","pointer").attr("fill","#B33A3A").attr("font-size",function(t){return"1.5em"}).text(function(t){return""}).on("mouseover",function(t){var e=d3.select("#news-box-"+t.data.id);e.style("visibility","visible")}).on("mouseout",function(t){var e=d3.select("#news-box-"+t.data.id);e.style("visibility","hidden")});var d=u.append("g").attr("width","500px").attr("height","500px").attr("x",function(t){return t.x-t.cWidth/2+"px"}).attr("y",function(t){return t.y-t.cHeight/2+"px"}).attr("id",function(t){return"news-box-"+t.data.id}),l=80,f=60;d.append("rect").attr("class","news-box").attr("fill","#ecf0f1").attr("width","80px").attr("height",l+"px").attr("x",function(t){return t.x+t.cWidth/2+"px"}).attr("y",function(t){return t.y-f+"px"}).attr("stroke","black").attr("stroke-width",2),d.append("foreignObject").attr("width","80px").attr("x",function(t){return t.x+t.cWidth/2+"px"}).attr("y",function(t){return t.y-55+"px"}).html(function(t){return'<p class="text-box"> Hello World </div>'})}},{key:"_flatten",value:function(t){function e(t){t.children&&t.children.forEach(e),t.id||(t.id=++r),n.push(t)}var n=[],r=0;return e(t),n}},{key:"_elbow",value:function(t,e){if(t.target.data.noParent)return"M0,0L0,0";var n=t.target.y+1*(t.source.y-t.target.y),r=-20;return"M "+t.target.x+" "+t.target.y+("l 0 "+2*r)+("m 0 "+r)+("L "+t.target.x+" "+n)+("L "+t.source.x+" "+t.source.y)}}],[{key:"_nodeSize",value:function(t,e,n){var r=0,a=document.createElement("svg");return document.body.appendChild(a),_.map(t,function(t){var i=document.createElement("div"),o="man",c="nice";i.setAttribute("class",o),i.style.visibility="hidden",i.style.maxWidth=e+"px";var s=n(t.data.name,t.data.data,c);i.innerHTML=s,a.appendChild(i);var u=i.offsetHeight;a.removeChild(i),r=Math.max(r,u),t.cHeight=u,t.cWidth=t.data.hidden?0:e}),document.body.removeChild(a),[e,r]}},{key:"depthToColorMap",value:function(t){var e={0:"#e74c3c",1:"#a29bfe",2:"#0984e3",3:"#fab1a0",4:"#636e72"},n=Object.keys(e).length;return e[t%n]}},{key:"_nodeRenderer",value:function(e){var n=e.append("g").attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.cWidth+"px"}).attr("height",function(t){return t.cHeight+"px"});n.append("rect").attr("width",function(t){return t.cWidth+"px"}).attr("height",function(t){return t.cHeight+"px"}).style("fill",function(e){return t.depthToColorMap(e.depth)});return n.append("text").attr("x",function(t){return t.cWidth/2+"px"}).attr("y",function(t){return t.cHeight/2+"px"}).style("fill","white").attr("class","name-text-box").attr("font-family","Source Sans Pro, sans-serif").attr("font-weight",800).attr("font-size","10px").attr("text-decoration","underline").attr("text-anchor","middle").text(function(t){return t.data.name}),console.log("hello world"),n.append("text").attr("x",function(t){return t.cWidth/2+"px"}).attr("y",function(t){return 10+t.cHeight/2+"px"}).style("fill","white").attr("font-family","Source Sans Pro, sans-serif").attr("font-weight",800).attr("font-size","6px").attr("text-anchor","middle").text(function(t){return t.data.location}),n}},{key:"_textRenderer",value:function(t,e,n){var r="";return r+="<p ",r+='align="center" ',r+='class="'+n+'">\n',r+=t,r+="</p>\n",e.percentage&&"N/A"!=e.percentage&&(r+='<p align="center" class="'+n+'"> '+e.percentage+"% </p>"),e.location&&(r+='<p align="center" class="'+n+'"> '+e.location+" </p>"),r}},{key:"_debug",value:function(e){t.DEBUG_LEVEL>0&&console.log(e)}}]),t}(),e={VERSION:"2.0.2",init:function(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=_.defaultsDeep(n||{},{target:"#graph",debug:!1,width:600,height:600,callbacks:{nodeClick:function(t,e,n){},nodeSize:function(e,n,r){return t._nodeSize(e,n,r)},nodeSorter:function(t,e,n,r){return 0},textRenderer:function(e,n,r){return t._textRenderer(e,n,r)}},margin:{top:50,right:0,bottom:0,left:0},nodeWidth:100,styles:{node:"node",linage:"linage",marriage:"marriage",text:"nodeText"}});this.process(e);var a=d3.hierarchy(e),i=new t(a,[],r);i.create()},mapClass:function(t){var e={person:"person",company:"company"};return e[t]},mapTextClass:function(t){var e={person:"person-text",company:"company-text"};return e[t]},addStyle:function(t,e){var n={"class":this.mapClass(e),textClass:this.mapTextClass(e)};_.merge(t,n)},listOfAttributes:["percentage","location","gender","news"],compactExtraInfo:function(t,e){t.data=_.pick(t,e)},process:function(t){if(t){var e=t.type;this.addStyle(t,e),this.compactExtraInfo(t,this.listOfAttributes);var n=this.process.bind(this);(t.children||[]).forEach(function(t){n(t)})}}};return e});
//# sourceMappingURL=dTree.min.js.map
